<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<!-- favicon -  thanks to https://favicon.io/favicon-generator/ -->
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
	<!-- JS and CSS -->
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
	<script src="js/retroWindowsScript.js"></script>
	<link rel="stylesheet" type="text/css" href="css/retroWindowsStyle.css" />
	<link rel="stylesheet" type="text/css" href="js/clippy.js/clippy.css" media="all"> <!-- could also use CDN: <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/clippyjs/clippy.js/build/clippy.css" media="all"> -->
	<script src="js/clippy.js/clippy.js"></script> <!-- could also use CDN: <script src="https://cdn.jsdelivr.net/gh/clippyjs/clippy.js/build/clippy.js"></script> -->
	<script src="node_modules/three/build/three.js"></script>
	<script src="node_modules/three/examples/js/loaders/GLTFLoader.js"></script>
	<script src="node_modules/three/examples/js/loaders/ColladaLoader.js"></script>
	<script src="node_modules/three/examples/js/controls/OrbitControls.js"></script>
	<script src="node_modules/three/examples/js/objects/Sky.js"></script>
	<title>A window into Pedro Natário's world</title>
</head>
<body>
	<canvas id="bg" style="position: fixed; top: 0; left: 0; "></canvas>
	<div id="desktop">
		<div class="window" data-title="Web Stuff">
			<p><a href="threejstests.html">Three.js racing</a>. Simple racing game using the amazing three.js library.</p>
			<hr />
			<p><a href="pixeltest.html">Lines and pixels</a>. How to draw simple elements on screen using no JS libraries nor WebGL -- only vanilla JS and HTML's 2D &lt;canvas&gt; context.</p>
			<hr />
			<p><a href="chartstests.html">Word frequency counter</a>. Bar graph (thanks to Chart.js) that shows the frequency of words in an input text.</p>
			<hr />
			<p>(I didn't use a packer/builder so JS code is available via "view source" - or on <a href="https://github.com/Natario/natario.github.io">my GitHub</a>)</p>
		</div>
		<div class="window" data-title="Small Theft Auto">
			<p>One of my first forays into the world of modern game development using Unreal Engine 5.</p>
			<p>(my first gamedev attempts were actually in the early 2000's with the almighty RPG Maker).</p>
			<p>This is a small game where you steal cars as quickly as possible.</p>
			<p>Most 3D models are from third parties, but the level design and game mechanics were created by me.</p>
			<p><a href="https://1drv.ms/u/s!At9qU0gJSyEGtFkP0dm5Hazfhqz9">Get it here</a> (Windows only for now) VERY ALPHA EXPECT BUGS!1</p>
			<p>To run, unzip and double click FirstProject.exe</p>
			<div class="preview">
				<!-- <p><a href="javascript:void(0)" onclick="$(this).parent().next().toggle()">Click here to show/hide preview video</a> (see in HD)</p> -->
				<p>Preview video (change quality to HD)</p>
				<p><iframe width="480" height="270" src="https://www.youtube.com/embed/xD0XOUPAF14" frameborder="0" allowfullscreen></iframe></p>
			</div>
		</div>
		<div class="window closed" data-title="Real Lisbon">
			<p>A rough 3D model of a part of the Portuguese city of Lisbon.</p>
			<p>The model was imported from Google Maps 3D data using a few tricks. To learn about this process, see <a href="https://www.youtube.com/watch?v=F_XsmoZJmG8">this</a> video and optionally also <a href="https://www.youtube.com/watch?v=XUkMY8Sp_AM">this</a> one.</p>
			<p><a href="https://1drv.ms/u/s!At9qU0gJSyEG_DEq_i0zMIsKV_O_">Get it here</a> (Windows only for now)</p>
			<p>To run, unzip and double click RealLisbon.exe</p>
			<p>Move - WASD, Run - LShift, Jump - Space, Exit - Esc.</p>
			<div class="preview">
				<p>Preview video (change quality to HD)</p>
				<p><iframe width="480" height="270" src="https://www.youtube.com/embed/cPRw2Wpu1Is" frameborder="0" allowfullscreen></iframe></p>
			</div>
		</div>
		<div class="window closed" data-title="3D Windmill">
			<p>This is a windmill 3D model I created in Blender as part of a course I took.</p>
			<p>I imported it into Unreal Engine 5 and made a simple scenario so that you can walk around the windmill</p>
			<p><a href="https://1drv.ms/u/s!At9qU0gJSyEGugyL-_8LZQbYaFkL">Get it here</a> (Windows only for now)</p>
			<p>To run, unzip and double click Windmill_Course.exe.</p>
			<div class="preview">
				<p>Preview video (change quality to HD)</p>
				<p><iframe width="480" height="270" src="https://www.youtube.com/embed/GjrwO6EpYV0" frameborder="0" allowfullscreen></iframe></p>
			</div>
			<p>You can also see a lower-quality version <a href="windmillthreejs.html">online</a> (takes about 30secs to load)</p>
		</div>
		<div class="window" data-title="OpenGL Racing">
			<p>This is a simple Micro Machines-like game I developed during my Computer Science BSc using C+++OpenGL.</p>
			<p>There are obstacles, a damage system and some power-ups granting speed and damage bonuses.</p>
			<p>In 2-player mode you gain points by being ahead of the other player.</p>
			<p><a href="https://1drv.ms/u/s!At9qU0gJSyEGgYRebBtu-bm8qZVDaw?e=MUTpuv">Get it here</a> (Windows)
				<a href="https://1drv.ms/u/s!At9qU0gJSyEGgYRdaSZ7CHQz6AiAZQ?e=kKeMAI">or here</a> (Linux).
				<a href="https://github.com/Natario/OpenGLRacing">Source here</a>.</p>
			<p>To run, unzip and execute Example.exe (Windows) or run $ ./test (Linux)</p>
			<p>To move: Player 1-arrow keys, Player 2-WASD; To leave: Esc</p>
			<div class="preview">
				<p>Preview video (change quality to 720p)</p>
				<p><iframe width="416" height="270" src="https://www.youtube.com/embed/Duab9-v2tBU" frameborder="0" allowfullscreen></iframe></p>
			</div>
		</div>
		<div class="window closed" data-title="3D Sword">
			<p>This is a scene modelled and animated in Blender with the help of
				<a href="https://www.youtube.com/watch?v=3QAGpxV36wM">these</a>
				<a href="https://www.youtube.com/watch?v=e3GCEEUnHPs">great</a>
				<a href="https://www.youtube.com/watch?v=s-XhO3OOPxQ">tutorials</a>.
			</p>
			<div class="preview">
				<p>Preview video (change quality to HD)</p>
				<p><iframe width="480" height="270" src="https://www.youtube.com/embed/RjGi1PAoQPA" frameborder="0" allowfullscreen></iframe></p>
			</div>
		</div>
		<div class="window closed" data-title="3D Furniture">
			<p>This is a set of table and chairs I modelled in Blender.</p>
			<p>Textures from <a href="https://polyhaven.com/">Poly Haven</a>.</p>
			<div class="preview">
				<p>Preview video (change quality to HD)</p>
				<p><iframe width="480" height="270" src="https://www.youtube.com/embed/iZ7_w9ofCV4" frameborder="0" allowfullscreen></iframe></p>
			</div>
		</div>
		<div class="window" data-title="Welcome">
			<h1>Hi</h1>
			<p>Hello</p>
			<p>Greetings</p>
			<p>I'm Pedro Natário, a software developer and an editor with a degree in computer science and another one in philosophy.</p>
			<p>This site was made with the aim of sharing my computer-related experiments (and it works much better on Desktop than Mobile).</p>
			<p>For the full list of projects see the menu in the top left of the desktop (behind the windows).</p>
			<p>Apologies in advance for the <span class="bentText">mess.</span></p>
			<hr />
			<p>You can find a more detailed CV at <a href="https://www.linkedin.com/in/pnatario">linkedin.com/in/pnatario</a></p>
		</div>

		<div id="taskbar">		
		</div>
		
		<div id="icons">
			<!-- fontawesome folder icons -->
			<!--<a class="openWindow" data-id="0"><p><i class="fas fa-folder-closed fa-3x"></i></p><p>Open web stuff</p></a>-->
			<a class="openWindow" data-id="0">Open Web Stuff</a>
			<a class="openWindow" data-id="1">Open Small Theft Auto</a>
			<a class="openWindow" data-id="2">Open Real Lisbon</a>
			<a class="openWindow" data-id="3">Open 3D Windmill</a>
			<a class="openWindow" data-id="4">Open OpenGL Racing</a>
			<a class="openWindow" data-id="5">Open 3D Sword</a>
			<a class="openWindow" data-id="6">Open 3D Furniture</a>
			<a class="openWindow" data-id="7">Welcome Screen</a>
		</div>
		<!-- <div><a id="bgColorChanger">I don't like this background color</a></div>
		<div><a id="bgColorReset">Actually I did</a></div> -->
		<div id="shoutOuts" class="preserveSpace">Thanks to <a href="https://threejs.org/">three.js</a>, <a href="https://html5-templates.com/" rel="nofollow">HTML5-Templates.com</a>, <a href="https://www.smore.com/clippy-js">smore</a>, and all the other great people on the web.</div>
		<!-- You can use this template freely if you leave a visible link to HTML5-Templates.com -->
	</div>
	<script type="text/javascript">

		/*
		 * Show Clippy
		 */
		clippy.load('Clippy', function(agent) {
			agent.show();
			// run a random animation every 60 secs
			setInterval(function() {
				agent.animate()
			}, 60 * 1000); //
		});


		
		/*
		 * Change background color on user click
		 */
		var timeoutID = undefined;
		$("#bgColorChanger").click(function(event) {
			
			// show little "ok" text where the click happened - https://stackoverflow.com/a/60837378/3174659
			// get mouse (event) location
			var x = event.clientX;
			var y = event.clientY;
			
			// create element to add, but first remove it if it exists already from a previous click
			if($("#okText").length > 0)
				$("#okText")[0].remove();
			var newthing = document.createElement("div");
			newthing.id = "okText";
			newthing.style.position = "fixed";
			newthing.style.left = x + "px";
			newthing.style.top = y + 30 + "px";
			newthing.innerText = "OK!";
			$("#desktop")[0].appendChild(newthing);
			
			// remove "ok" text after a while so it doesn't stay there forever - https://stackoverflow.com/a/820954/3174659
			clearTimeout(timeoutID); // reset timeout from previous click
			timeoutID = setTimeout(function() {
				$('#okText').fadeOut('fast');
			}, 1000);
			
			// change color (from Kirupa Chinnathambi - Creating Web Animations (2017))
			var zeros = "0000000";
			var color = "#" + Math.floor(Math.random() * 0xFFFFFF).toString(16);
			var colorLength = color.length;
			if (colorLength < 7) {
				color += zeros.substring(0, zeros.length - colorLength);
			}
			$("#desktop")[0].style.backgroundColor = color;
		});

		// Reset color on user click
		$("#bgColorReset").click(function() {
			$("#desktop")[0].style.backgroundColor = "#CCC";
		});



		/*
		 * Three.js background - https://www.youtube.com/watch?v=Q7AOvWpIVHU
		 * basically I just took the idea of using a three.js scene covering the whole background (using position: fixed) and not all the other animations
		 */

		// SETUP
		const scene = new THREE.Scene();
		// scene.background = new THREE.Color( 'dodgerblue' );
		// scene.background = new THREE.TextureLoader().load('img/clouds2.jpg');
		
		const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 2000);
		camera.position.z = 26;

		const renderer = new THREE.WebGLRenderer({canvas: document.querySelector('#bg')});
		renderer.setPixelRatio(window.devicePixelRatio);
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.render(scene, camera);

		const controls = new THREE.OrbitControls( camera, renderer.domElement );

		// const axesHelper = new THREE.AxesHelper( 100 );
		// scene.add(axesHelper);
		

		// LIGHTS AND SKY
		// const ambientLight = new THREE.AmbientLight( 0x404040, 4); // soft white light
		// scene.add( ambientLight );
		
		// const directionalLight = new THREE.DirectionalLight('white', 3);
		// directionalLight.position.set(0, 30, 100);
		// scene.add(directionalLight);
		
		const spotLight = new THREE.SpotLight('white', 5, 400, Math.PI / 2.4);
		spotLight.position.set(2, 8, 10);
		spotLight.target.position.set(2, -10, 0);
		scene.add(spotLight);
		const spotLightHelper = new THREE.SpotLightHelper( spotLight );
		spotLightHelper.visible = false; // have to hide it this way because if I remove the code for the spotLightHelper, then I can't move the spotlight...
		scene.add( spotLightHelper );
		
		const sky = new THREE.Sky();
		sky.scale.setScalar( 10000 );
		sky.material.uniforms[ 'sunPosition' ].value.set(0,3,10);
		sky.material.uniforms[ 'rayleigh' ].value = 1;
		sky.material.uniforms[ 'turbidity' ].value = 5;
		sky.material.uniforms[ 'mieCoefficient' ].value = 0.01;
		sky.material.uniforms[ 'mieDirectionalG' ].value = 0.9;
		scene.add( sky );

		// Skybox to use instead of THREE.Sky() - https://r105.threejsfundamentals.org/threejs/lessons/threejs-backgrounds.html
		// const geometry = new THREE.BoxGeometry( 1, 1, 1 );
		// const textureLoader = new THREE.TextureLoader();
		// const material = new THREE.MeshStandardMaterial( {map: textureLoader.load('img/sky_seamless2.jpg')} );
		// material.side = THREE.BackSide;
		// const cube = new THREE.Mesh( geometry, material );
		// cube.scale.setScalar(1500);
		// scene.add(cube);


		// OBJECTS
		const gltfLoader = new THREE.GLTFLoader();
		const colladaLoader = new THREE.ColladaLoader();
		let model, model2;
		//
		// TO use FBXLoader, we need to also include "three/examples/js/libs/fflate.min.js"
		// BUT even with that extra lib, the GLTFLoader (.gltf/.glb) and the ColladaLoader (.dae) seem to work better.
		// 
		// HOWEVER, for .glb models that throw the error "THREE.GLTFLoader: Unknown extension "KHR_materials_pbrSpecularGlossiness"."
		// we need to remove that extension from the model by importing and then exporting the model at https://gltf.report/
		// For details about three.js's deprecation of this extension see https://github.com/mrdoob/three.js/pull/24950
		// and see also the tool author's explanation at https://www.donmccurdy.com/2022/11/28/converting-gltf-pbr-materials-from-specgloss-to-metalrough/
		// 
		// ALSO, for .dae files we EITHER need to remove white lines with:
		// "model2.children[0].children.forEach(child => { if(child.type == "LineSegments")child.visible = false; });"
		// OR use a tool like https://imagetostl.com/convert/file/dae/to/glb to convert .dae to .glb and import with GLTFLoader
		//
		gltfLoader.load( 'img/mount_rough.glb', function ( file ) {
			// console.log(file);
			model = file.scene;
			model2 = model.clone();
			model.scale.set(0.2,0.075,0.1);
			model.position.x = 0;
			model.position.y = -5;
			model2.scale.set(0.2,0.12,0.2);
			model2.position.x = 55;
			model2.position.y = -10;
			model2.position.z = -50;
			scene.add(model, model2);
		});
		// gltfLoader.load( 'img/win2.glb', function ( file ) {
		// 	// console.log(file);
		// 	model2 = file.scene;
		// 	model2.position.x = 7;
		// 	model2.position.y = 2.5;
		// 	model2.position.z = 15;
		// 	model2.scale.setScalar(0.5);
		// 	model2.rotation.y = -0.15;
		// 	scene.add(model2);
		// });
		// colladaLoader.load( 'img/hill.dae', function ( file ) {
		// 	console.log(file);
		// 	model2 = file.scene;
		// 	model2.children[0].children.forEach(child => {
		// 		if(child.type == "LineSegments")
		// 			child.visible = false;
		// 	});
		// 	model2.position.y = 10;
		// 	model2.scale.setScalar( 0.01 );
		// 	scene.add( model2 );
		// });
		

		// ANIMATIONS AND UPDATES
		function animate() {
			requestAnimationFrame(animate);
			// if(model2)model2.rotation.y = Math.sin(Date.now() * 0.003) * Math.PI * 0.02; // https://stackoverflow.com/a/40971141/3174659
			controls.update();
			renderer.render(scene, camera);
		}
		animate();

		// Resize scene on window resize - https://discoverthreejs.com/book/first-steps/responsive-design/
		window.addEventListener("resize", () => {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();

			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.setPixelRatio(window.devicePixelRatio);

			// do not stretch background image when resizing window - https://stackoverflow.com/a/60842693/3174659
			// const targetAspect = window.innerWidth / window.innerHeight;
			// const imageAspect = 1920 / 1277;
			// const factor = imageAspect / targetAspect;
			// // When factor larger than 1, that means texture 'wilder' than target. We should scale texture height to target height and then 'map' the center of texture to target，and vice versa.
			// scene.background.offset.x = factor > 1 ? (1 - 1 / factor) / 2 : 0;
			// scene.background.repeat.x = factor > 1 ? 1 / factor : 1;
			// scene.background.offset.y = factor > 1 ? 0 : (1 - factor) / 2;
			// scene.background.repeat.y = factor > 1 ? 1 : factor;
		});

	</script>
</body>

</html>